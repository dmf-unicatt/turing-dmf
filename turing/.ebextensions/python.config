packages:
  yum:
    git: []

option_settings:
  aws:elasticbeanstalk:application:environment:
    DEBUG: False
    DEV_MODE: False
    DJANGO_SETTINGS_MODULE: "Turing.settings"
  aws:elasticbeanstalk:container:python:
    WSGIPath: "Turing.wsgi:application"
    NumProcesses: 2
    NumThreads: 20
  aws:elasticbeanstalk:environment:proxy:staticfiles:
    /static: static

container_commands:
  00_logdir:
    command: mkdir -p /var/log/app-logs
  10_install_postgres:
    command: "$PYTHONPATH/pip install psycopg2-binary"
  20_collectstatic:
    command: "$PYTHONPATH/python manage.py collectstatic --noinput"
  30_migrate:
    command: "$PYTHONPATH/python manage.py makemigrations engine && $PYTHONPATH/python manage.py migrate --noinput"
    leader_only: true
  # 03_createsu:
  #   command: "$PYTHONPATH/python manage.py createsu"
  #   leader_only: true
  # 04_loadnames:
  #   command: "$PYTHONPATH/python manage.py load_teams 3 elenco_squadre_psw.csv"
  #   leader_only: true
  99_permissions_log:
    command: chown -R webapp:webapp /var/log/app-logs && chmod -R 777 /var/log/app-logs
